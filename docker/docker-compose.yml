version: '3.8'

services:
  webhook-lb:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    container_name: webhook-load-balancer
    ports:
      - "8048:8048"
    # 如果需要环境变量，取消下面的注释并配置
    # environment:
    #   HOST: 0.0.0.0
    #   PORT: 8048
    volumes:
      # 挂载日志目录，方便查看日志
      - ../logs:/app/logs
      # 挂载 .env 配置文件，使容器可以读取环境变量配置
      - ../.env:/app/.env:ro
      # 挂载 providers_config.py 文件，使容器可以读取提供者配置
      - ../providers_config.py:/app/providers_config.py:ro
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8048/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 5s

